\chapter{Resultados}

%El dispositivo fabricado tiene las caracter\'isticas detalladas en la tabla \ref{tabla:caracteristicas_fabricado}. 

%\begin{table}
%		\begin{center}
%			\caption{Caracter\'isticas del dispositivo fabricado.}
%			\label{tabla:caracteristicas_fabricado}
%			\small
%			\begin{tabular}{r|m{7cm}}
%				\toprule
%				\textbf{Caracter\'istica} & \textbf{Descripci\'on}\\
%				\midrule
%				Unidad de procesamiento & 	System On Chip formado por un microcontrolador Atmel ATMega128 y un radio transceptor ZigBee 802.15.4 a 2.4 GHz\\
%				Perif\'ericos & 5 puertos digitales I/O, 18 puertos multifunci\'on (PWM, ADC, INT), 1 puerto RS-232, 1 puerto JTAG y 1 puerto SPI\\
%				\bottomrule			
%			\end{tabular}
%		\end{center}
%\end{table}

\section{Verificaci\'on de funcionamiento del dispositivo}

El proceso de pruebas consiste en una serie de pruebas a los distintos componentes que lo forman, las cuales se listan a continuaci\'on:

\begin{itemize}
\item Verificaci\'on f\'isica del dispositivo y comprobaci\'on de funcionamiento en el rango de voltaje esperado, 
\item Verificaci\'on del funcionamiento del microcontrolador, 
\item Medici\'on de consumo de corriente, 
\item Medici\'on de alcance de radio comunicaci\'on.
\end{itemize}

A continuaci\'on se detalla cada una de estas pruebas realizadas. 

\subsection{Verificaci\'on f\'isica del dispositivo}

Luego de la fabricaci\'on del dispositivo se realiz\'o una verificaci\'on de cortos circuitos, la prueba consiste en medir la resistencia entre la l\'inea de alimentaci\'on de voltaje y la l\'inea de tierra, esto con la finalidad de evitar da\~nos en el dispositivo al aplicar voltaje por primera vez. Tambi\'en se verificaron cortos circuitos entre las l\'ineas de comunicaci\'on serial y puertos de prop\'osito general. En estas pruebas no se encontraron errores en el dispositivo. 

% De hecho si se encontraron errores aqui, los leds estaban en la posicion incorrecta, el dispositivo se 
% envio a la fabrica para reparar el error. No es un error interesante y por lo tanto lo estoy dejando fuera de los resultados. 

Se verific\'o el voltaje de operaci\'on y se logr\'o encender el dispositivo en el rango de 3.3 a 16 Vcd.

%Para comprobar el funcionamiento del dispositivo luego de su fabricaci\'on, se le realizaron las siguientes pruebas:  

%\begin{itemize}
%\item Pruebas de funcionamiento el\'ectrico,
%\item Pruebas de funcionamiento de componentes.
%\end{itemize}

%Las pruebas de funcionamiento el\'ectrico consisten en la verificaci\'on de la operaci\'on del dispositivo en el rango de voltaje definido en la etapa de dise\~no y en la revisi\'on del consumo de corriente del dispositivo en sus distintas etapas de operaci\'on (en modo de ahorro de energ\'ia, en modo de espera y en modo de transmisi\'on de datos). 

%Por otro lado, las pruebas de funcionamiento de componentes consisten en la verificaci\'on del funcionamiento de cada uno de los componentes que forman al dispositivo. Pruebas tales como la verificaci\'on de la interfaz de programaci\'on del microcontrolador, la verificaci\'on del funcionamiento de los puertos de prop\'osito general, puerto serial y radio comunicaci\'on. 

\subsection{Verificaci\'on de funcionamiento del microcontrolador}

Una vez que se ha comprobado del funcionamiento el\'ectrico del dispositivo se verifica el estado del microcontrolador, en particular se comprueba que: 

\begin{itemize}
\item El funcionamiento de las interfaces JTAG y SPI. Se comprueba en este paso la capacidad del dispositivo de ser programado, 
\item Comprobaci\'on de puertos de prop\'osito general,
\item Verificaci\'on del funcionamiento de la interfaz de comunicaci\'on serial, 
\item Verificaci\'on del funcionamiento de la radio comunicaci\'on.
\end{itemize}



\subsection{Medici\'on de consumo de corriente}

Posteriormente se realizaron pruebas de consumo de corriente en distintas etapas de operaci\'on para lo cual se consideraron tres etapas de operaci\'on: 

\begin{itemize}
\item Modo de transmisi\'on de datos: Todos los componentes del dispositivo est\'an encendidos y se realiza comunicaci\'on inal\'ambrica con otro dispositivo,
\item Modo de espera: Todos los componentes del dispositivo est\'an encendidos pero no se realiza comunicaci\'on inal\'ambrica, 
\item Modo de ahorro de energ\'ia: El microcontrolador es enviado a modo de ahorro de energ\'ia, sin embargo algunos componentes externos siguen en funcionamiento. 
\end{itemize}

Estas pruebas requieren que el funcionamiento de los componentes sea el esperado, dichas pruebas se detallan m\'as adelante. Utilizando la aplicaci\'on de prueba WSNDemo de BitCloud en dos dispositivos SerialDongle, se realiz\'o el siguiente experimento,

\begin{enumerate}
\item Programar un dispositivo como nodo coordinador,
\item Programar un segundo dispositivo como nodo final,
\item Encender ambos dispositivos y verificar la conexi\'on inal\'ambrica,
\item Aplicando un voltaje de 5 Vcd, se mide el consumo de corriente en ambos dispositivos. 
\end{enumerate}

WSNDemo es una aplicaci\'on de prueba de BitCloud que tiene la finalidad de demostrar la funcionalidad b\'asica de BitCloud. Su funci\'on consiste en registrar un nodo como coordinador de la red, mientras que otros nodos se registran en la red como nodos finales. El nodo coordinador estar\'a esperando a que alguno de los nodos env\'ie informaci\'on, cuando \'esta es recibida enviar\'a los datos por la interfaz serial. 
Por otro lado, el nodo final una vez encendido y registrado en la red, recolectar\'a datos como temperatura y voltaje del dispositivo (informaci\'on que provee el mismo microcontrolador) y enviar\'a esta informaci\'on al nodo coordinador para posteriormente entrar en modo de ahorro de energ\'ia. Luego de cierto tiempo el nodo volver\'a en funcionamiento normal para volver a enviar m\'as informaci\'on. 

Se midi\'o el consumo de corriente cuando : 

\begin{itemize}
\item El nodo coordinador est\'a en funcionamiento sin ning\'un nodo final conectado, ver figura \ref{fig:coordinador_sinnodo},
\item El nodo coordinador establece comunicaci\'on con un nodo final, ver figura \ref{fig:coordinador_connodo},
\item El nodo final env\'ia datos el nodo coordinador, ver figura \ref{fig:consumo_enddevice}.
\end{itemize}

\begin{figure}
	\centering
	\includegraphics[scale=0.5]{capitulo_4_imgs/corriente_sd_sinnodo.pdf}
	\caption{Consumo de corriente como nodo coordinador sin nodo final conectado.}
	\label{fig:coordinador_sinnodo}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[scale=0.5]{capitulo_4_imgs/corriente_sd_connodo.pdf}
	\caption{Consumo de corriente como nodo coordinador con nodo final conectado.}
	\label{fig:coordinador_connodo}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[scale=0.5]{capitulo_4_imgs/corriente_sd_enddevice.pdf}
	\caption{Consumo de corriente del dispositivo como nodo final.}
	\label{fig:consumo_enddevice}
\end{figure}

%Adicionalmente se realiz\'o el mismo experimento con los nodos Atmel RZRaven, detallados en el cap\'itulo 2, con el fin de comparar el consumo de corriente del dispositivo fabricado con este producto comercial. Estos resultados se pueden ver en las figuras. 

% TODO: Agregar figuras de consumo de corriente los nodos Raven.

\subsection{Medici\'on de alcance de radio comunicaci\'on}



Pruebas de voltaje y corriente, verificaci\'on de cortos. 
Agregar tabla de voltaje y corriente leido (obtener del cartel)

Pruebas al microcontrolador: Test de programacion y puerto JTAG, programa de ejemplo. Test de puertos, puerto serial. 
Test de radio (prueba con software de ejemplo de BitCloud), agregar la prueba de comunicacion y distancia aqui. ASi como de los consumos de corriente y la comparacion con el otro dispositivo. 

Estas son las pruebas para conocer el estado funcional del dispositivo. 

\section{Pruebas de software}

\subsection{Aplicaci\'on de ejemplo}

\subsection{Resultados de ejecuci\'on}

